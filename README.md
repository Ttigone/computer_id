# Build and Install Instructions

```bash
# å®‰è£… vcpkg
git clone https://github.com/Microsoft/vcpkg.git
cd vcpkg
.\bootstrap-vcpkg.bat
.\vcpkg integrate install
```

```bash
# å®‰è£…ä¾èµ–
vcpkg install openssl:x64-windows
vcpkg install curl:x64-windows
vcpkg install nlohmann-json:x64-windows  # å¯é€‰
```

# Windows æœºå™¨ç æˆæƒç³»ç»Ÿ

ä¸€ä¸ªå®Œæ•´çš„åŸºäºç¡¬ä»¶ä¿¡æ¯çš„ Windows è½¯ä»¶æˆæƒç³»ç»Ÿï¼ŒåŒ…å«å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®¢æˆ·ç«¯ï¼ˆQt UI + çº¯ C++ï¼‰

```bash
# ç¼–è¯‘å¹¶è¿è¡Œ Qt åº”ç”¨
cd qt_hybrid
# ä½¿ç”¨ Visual Studio æ‰“å¼€ CMakeLists.txt
```

è¯¦ç»†è¯´æ˜ï¼š[Qt Hybrid å®¢æˆ·ç«¯æ–‡æ¡£](qt_hybrid/README.md)

### æœåŠ¡ç«¯ï¼ˆPython Flaskï¼‰

```bash
# å¿«é€Ÿå¯åŠ¨æœåŠ¡å™¨
cd server
python secure_license_server.py
```

è¯¦ç»†è¯´æ˜ï¼š
- **å¿«é€Ÿå…¥é—¨**: [server/QUICKSTART.md](server/QUICKSTART.md) â­ æ¨è
- **å®Œæ•´éƒ¨ç½²**: [server/DEPLOYMENT.md](server/DEPLOYMENT.md)

---

## åŠŸèƒ½ç‰¹æ€§

- âœ… è·å–å”¯ä¸€çš„æœºå™¨æ ‡è¯†ç ï¼ˆåŸºäº CPUã€ä¸»æ¿ã€ç¡¬ç›˜åºåˆ—å·ï¼‰
- âœ… å¤šå±‚åŠ å¯†å®‰å…¨ä¿æŠ¤ï¼ˆHTTPS + HMAC-SHA256 + æ—¶é—´æˆ³éªŒè¯ï¼‰
- âœ… Qt å›¾å½¢ç•Œé¢å®¢æˆ·ç«¯ï¼ˆWindowsï¼‰
- âœ… Python Flask æœåŠ¡ç«¯ï¼ˆè·¨å¹³å°ï¼‰
- âœ… å®Œæ•´çš„è®¸å¯è¯ç®¡ç†ç³»ç»Ÿ
- âœ… é˜²é‡æ”¾æ”»å‡»å’Œæš´åŠ›ç ´è§£ä¿æŠ¤

## æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Qt Client (Windows)             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  UI Layer (Qt Widgets)           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚              â”‚                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Business Logic (Pure C++)       â”‚   â”‚
â”‚  â”‚  - WMI Machine Code              â”‚   â”‚
â”‚  â”‚  - OpenSSL Encryption            â”‚   â”‚
â”‚  â”‚  - libcurl HTTP Client           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ HTTPS
               â”‚ HMAC-SHA256
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Flask Server (Linux/Windows)        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  License Management API            â”‚  â”‚
â”‚  â”‚  - Request License                 â”‚  â”‚
â”‚  â”‚  - Verify License                  â”‚  â”‚
â”‚  â”‚  - Query License Info              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚               â”‚                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  SQLite Database                   â”‚  â”‚
â”‚  â”‚  - Machine Codes                   â”‚  â”‚
â”‚  â”‚  - License Keys                    â”‚  â”‚
â”‚  â”‚  - Expiration Dates                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æŠ€æœ¯å®ç°

### ç¡¬ä»¶ä¿¡æ¯é‡‡é›†
- **CPU ID**: é€šè¿‡ WMI æŸ¥è¯¢ `Win32_Processor.ProcessorId`
- **ä¸»æ¿åºåˆ—å·**: é€šè¿‡ WMI æŸ¥è¯¢ `Win32_BaseBoard.SerialNumber`
- **ç¡¬ç›˜åºåˆ—å·**: é€šè¿‡ WMI æŸ¥è¯¢ `Win32_DiskDrive.SerialNumber`

### æœºå™¨ç ç”Ÿæˆ
ç»„åˆå¤šä¸ªç¡¬ä»¶ä¿¡æ¯åä½¿ç”¨ SHA256 å“ˆå¸Œç®—æ³•ç”Ÿæˆ64ä½åå…­è¿›åˆ¶å­—ç¬¦ä¸²ä½œä¸ºå”¯ä¸€æ ‡è¯†ã€‚

### æˆæƒéªŒè¯
åŸºäºæ–‡ä»¶çš„è®¸å¯è¯ç³»ç»Ÿï¼Œä½¿ç”¨åŒé‡å“ˆå¸Œé˜²æ­¢åå‘æ¨å¯¼ã€‚

## ä½¿ç”¨æµç¨‹

### 1. å®¢æˆ·ç«¯è·å–æœºå™¨ç 

```bash
computer_id.exe --get-code
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
======================================
  è·å–æœºå™¨ç 
======================================

ç¡¬ä»¶ä¿¡æ¯:
  CPU ID:       BFEBFBFF000906E9
  ä¸»æ¿åºåˆ—å·:   /0123456789/
  ç¡¬ç›˜åºåˆ—å·:   WD-WCC4E0123456

æœºå™¨ç : a1b2c3d4e5f67890abcdef1234567890abcdef1234567890abcdef1234567890

è¯·å°†ä»¥ä¸Šæœºå™¨ç å‘é€ç»™æœåŠ¡ç«¯è¿›è¡Œæˆæƒç”³è¯·ã€‚
```

### 2. æœåŠ¡ç«¯ç”Ÿæˆè®¸å¯è¯

å®¢æˆ·ç«¯æä¾›æœºå™¨ç åï¼Œåœ¨æœåŠ¡ç«¯è¿è¡Œï¼š

```bash
computer_id.exe --generate a1b2c3d4e5f67890abcdef1234567890abcdef1234567890abcdef1234567890
```

è¿™å°†ç”Ÿæˆ `license.dat` æ–‡ä»¶ï¼Œå°†æ­¤æ–‡ä»¶å‘é€ç»™å®¢æˆ·ç«¯ã€‚

### 3. å®¢æˆ·ç«¯éªŒè¯æˆæƒ

å®¢æˆ·ç«¯æ”¶åˆ° `license.dat` åï¼Œæ”¾åœ¨ç¨‹åºç›®å½•ä¸‹ï¼Œè¿è¡Œï¼š

```bash
computer_id.exe --verify
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
======================================
  éªŒè¯æˆæƒ
======================================

å½“å‰æœºå™¨ç : a1b2c3d4e5f67890abcdef1234567890abcdef1234567890abcdef1234567890
æ­£åœ¨éªŒè¯è®¸å¯è¯...

[æˆåŠŸ] âœ“ æˆæƒéªŒè¯é€šè¿‡ï¼è½¯ä»¶å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚
```

## é›†æˆåˆ°ä½ çš„è½¯ä»¶

åœ¨ä½ çš„è½¯ä»¶å¯åŠ¨ä»£ç ä¸­æ·»åŠ ï¼š

```cpp
#include "win_product.h"

int main()
{
    // éªŒè¯æˆæƒ
    LicenseManager licMgr;
    
    if (!licMgr.VerifyLicense("license.dat"))
    {
        printf("è½¯ä»¶æœªæˆæƒï¼\n");
        printf("æ‚¨çš„æœºå™¨ç æ˜¯: %s\n", licMgr.GetMachineCode().c_str());
        printf("è¯·è”ç³»æœåŠ¡ç«¯è·å–æˆæƒã€‚\n");
        return 1;
    }
    
    // æˆæƒé€šè¿‡ï¼Œç»§ç»­æ‰§è¡Œè½¯ä»¶é€»è¾‘
    printf("è½¯ä»¶å·²æˆæƒï¼Œæ­£å¸¸å¯åŠ¨...\n");
    
    // ä½ çš„è½¯ä»¶ä»£ç ...
    
    return 0;
}
```

## å®‰å…¨è¯´æ˜

1. **å¯†é’¥ä¿æŠ¤**: ä¿®æ”¹ `DEFAULT_SECRET_KEY_2026` ä¸ºä½ è‡ªå·±çš„å¯†é’¥ï¼Œå¹¶å¦¥å–„ä¿ç®¡
2. **é€šä¿¡åŠ å¯†**: å®é™…ç”Ÿäº§ç¯å¢ƒå»ºè®®é€šè¿‡ HTTPS ä¼ è¾“æœºå™¨ç å’Œè®¸å¯è¯
3. **æ–‡ä»¶ä¿æŠ¤**: å¯ä»¥å¯¹ `license.dat` æ–‡ä»¶è¿›è¡Œé¢å¤–åŠ å¯†
4. **æ—¶é—´éªŒè¯**: å¯ä»¥åœ¨è®¸å¯è¯ä¸­æ·»åŠ æœ‰æ•ˆæœŸéªŒè¯
5. **åœ¨çº¿éªŒè¯**: å¯ä»¥æ‰©å±•ä¸ºè”ç½‘éªŒè¯æ¨¡å¼

## é«˜çº§åŠŸèƒ½æ‰©å±•

### æ·»åŠ æœ‰æ•ˆæœŸéªŒè¯

å¯ä»¥ä¿®æ”¹ `GenerateLicenseFile` å‡½æ•°ï¼Œåœ¨è®¸å¯è¯ä¸­åŒ…å«æ—¶é—´æˆ³ï¼š

```cpp
// è®¸å¯è¯æ ¼å¼: æœºå™¨ç |è¿‡æœŸæ—¶é—´æˆ³
std::string licenseData = machineCode + "|" + std::to_string(expiryTimestamp);
std::string licenseContent = Sha256(licenseData + secretKey);
```

### æ·»åŠ ç½‘ç»œéªŒè¯

```cpp
bool VerifyLicenseOnline(const std::string& machineCode)
{
    // å‘æœåŠ¡å™¨å‘é€éªŒè¯è¯·æ±‚
    // ä½¿ç”¨ WinHTTP æˆ– curl åº“
    // POST https://yourserver.com/api/verify
    // Body: {"machine_code": "xxx"}
    
    // è§£ææœåŠ¡å™¨å“åº”
    // è¿”å›éªŒè¯ç»“æœ
}
```

### æ·»åŠ ç‰¹å¾ç ä¿æŠ¤

åœ¨è®¸å¯è¯ä¸­åŠ å…¥è½¯ä»¶ç‰ˆæœ¬ã€åŠŸèƒ½æ¨¡å—ç­‰ä¿¡æ¯ï¼Œå®ç°æ›´ç»†ç²’åº¦çš„æˆæƒæ§åˆ¶ã€‚

## ç¼–è¯‘è¯´æ˜

éœ€è¦é“¾æ¥ä»¥ä¸‹åº“ï¼š
- `wbemuuid.lib` - WMI æ”¯æŒ
- `advapi32.lib` - åŠ å¯† API æ”¯æŒ

Visual Studio é¡¹ç›®é…ç½®ï¼š
- å¹³å°: Windows
- å­—ç¬¦é›†: å¤šå­—èŠ‚æˆ– Unicode
- C++ æ ‡å‡†: C++11 æˆ–æ›´é«˜

## æ³¨æ„äº‹é¡¹

1. ç¡¬ä»¶æ›´æ¢åæœºå™¨ç ä¼šæ”¹å˜ï¼Œéœ€è¦é‡æ–°æˆæƒ
2. è™šæ‹Ÿæœºç¯å¢ƒå¯èƒ½æ— æ³•è·å–æŸäº›ç¡¬ä»¶ä¿¡æ¯
3. éœ€è¦ç®¡ç†å‘˜æƒé™æ‰èƒ½è®¿é—®æŸäº› WMI ä¿¡æ¯ï¼ˆä¸€èˆ¬ä¸éœ€è¦ï¼‰
4. å»ºè®®é‡‡é›†å¤šä¸ªç¡¬ä»¶ä¿¡æ¯ä»¥æé«˜ç¨³å®šæ€§

## æˆæƒæµç¨‹å›¾

```
å®¢æˆ·ç«¯                           æœåŠ¡ç«¯
   |                               |
   |  1. è·å–æœºå™¨ç                 |
   |----------------------------->|
   |                              |
   |  2. å‘é€æœºå™¨ç è¯·æ±‚æˆæƒ        |
   |----------------------------->|
   |                              |
   |                    3. éªŒè¯å¹¶ç”Ÿæˆè®¸å¯è¯
   |                              |
   |  4. è¿”å› license.dat         |
   |<-----------------------------|
   |                              |
   |  5. éªŒè¯è®¸å¯è¯                |
   |  6. è¿è¡Œè½¯ä»¶                  |
```

## è®¸å¯è¯

MIT License - å¯è‡ªç”±ä¿®æ”¹å’Œå•†ç”¨
